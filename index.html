<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive 3D Media Viewer</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script>
      // Component to change the main screen image
      AFRAME.registerComponent("media-button", {
        schema: {
          src: { type: "string" },
          mediaType: { type: "string", default: "image" }
        },
        init: function () {
          const el = this.el;
          const data = this.data;
          let isActive = false;

          // Create hover sound
          const hoverSound = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTGH0fPTgjMGHm7A7+OZUQ0PVqzn77BdGQU+ltrzxnMpBSx+zPLaizsIGGS57OihUhELTKXh8bllHAU2jtT0yoA0Bx1rv/DhmFINEFWs5+6wXBkFPpTS88Z0KwUsfszx2os7CBhkuezooVIRC0yl4fG5ZRwFNo7U9MqANAcda7/w4ZhSDRBVrOfusF0ZBT6U0vPGdCsFLH7M8dqLOwgYZLns6KFSEQtMpeHxuWUcBTaO1PTKgDQHHWu/8OGYUQ0QVazn7rBdGQU+lNLzxnUrBSx+zPHaizsIGGS57OihUhELTKXh8bllHAU2jtT0yoA0Bx1rv/DhmFINEFWs5+6wXRkFPpTS88Z1KwUsfszx2os7CBhkuezooVIRC0yl4fG5ZRwFNo7U9MqANAcda7/w4ZhSDRBVrOfusF0ZBT6U0vPGdSsFLH7M8dqLOwgYZLns6KFSEQtMpeHxuWUcBTaO1PTKgDQHHWu/8OGYUQ0QVazn7rBdGQU+lNLzxnUrBSx+zPHaizsIGGS57OihUhELTKXh8bllHAU2jtT0yoA0Bx1rv/DhmFINEFWs5+6wXRkFPpTS88Z1KwUsfszx2os7CBhkuezooVIRC0yl4fG5ZRwFNo7U9MqANAcda7/w4ZhSDRBVrOfusF0ZBT6U0vPGdSsFLH7M8dqLOwgYZLns6KFSEQtMpeHxuWUcBTaO1PTKgDQHHWu/8OGYUQ0QVazn7rBdGQU+lNLzxnUrBSx+zPHaizsIGGS57OihUhELTKXh8bllHAU2jtT0yoA0Bx1rv/DhmFINEFWs5+6wXhkFPpTS88Z1KwUsfszx2os7CBhkuezooVIRC0yl4fG5ZRwFNo7U9MqANAcda7/w4ZhSDRBVrOfusF0ZBT6U0vPGdSsFLH7M8dqLOwgYZLns6KFSEQtMpeHxuWUcBTaO1PTKgDQHHWu/8OGYUQ0QVazn7rBdGQU+lNLzxnUrBSx+zPHaizsIGGS57OihUhELTKXh8bllHAU2jtT0yoA0Bx1rv/DhmFINEFWs5+6wXRkFPpTS88Z1KwUsfszx2os7CBhkuezooVIRC0yl4fG5ZRwFNo7U9MqANAcda7/w4ZhSDRBVrOfusF0ZBT6U0vPGdSsFLH7M8dqLPAgYZLns6KFSEQtMpeHxuWUcBTaO1PTKgDQHHWu/8OGYUQ0QVazn7rBdGQU+lNLzxnUrBSx+zPHaizsIGGS57OihUhELTKXh8bllHAU2jtT0yoA0Bx1rv/DhmFENEFWs5+6wXRkFPpTS88Z1KwUsfszx');
          const clickSound = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTGH0fPTgjMGHm7A7+OZUQ0PVqzn77BdGQU+ltrzxnMpBSx+zPLaizsIGGS57OihUhELTKXh8bllHAU2jtT0yoA0Bx1rv/DhmFINEFWs5+6wXBkFPpTS88Z0KwUsfszx2os7CBhkuezooVIRC0yl4fG5ZRwFNo7U9MqANAcda7/w4ZhSDRBVrOfu');

          // Visual feedback: hover
          el.addEventListener("mouseenter", () => {
            if (!isActive) {
              el.setAttribute("scale", "1.15 1.15 1.15");
              el.setAttribute("material", "emissive", "#444");
              hoverSound.currentTime = 0;
              hoverSound.volume = 0.3;
              hoverSound.play().catch(() => {});
            }
          });

          el.addEventListener("mouseleave", () => {
            if (!isActive) {
              el.setAttribute("scale", "1 1 1");
              el.setAttribute("material", "emissive", "#000");
            }
          });

          // Visual feedback: click
          el.addEventListener("mousedown", () => {
            el.setAttribute("scale", "0.95 0.95 0.95");
          });

          el.addEventListener("mouseup", () => {
            el.setAttribute("scale", isActive ? "1 1 1" : "1.15 1.15 1.15");
          });

          // On click, update the main screen texture
          el.addEventListener("click", () => {
            clickSound.currentTime = 0;
            clickSound.volume = 0.5;
            clickSound.play().catch(() => {});

            // Reset all buttons
            document.querySelectorAll('.media-btn').forEach(btn => {
              btn.setAttribute("material", "emissive", "#000");
              btn.setAttribute("scale", "1 1 1");
              btn.components['media-button'].isActive = false;
            });

            // Activate this button
            isActive = true;
            el.setAttribute("material", "emissive", "#FFD700");
            el.setAttribute("scale", "1 1 1");

            const screen = document.querySelector("#media-screen");
            
            if (data.mediaType === "video") {
              // Handle video
              const video = document.querySelector("#video1");
              video.pause();
              video.currentTime = 0;
              
              // If src is different, update it
              if (video.getAttribute("src") !== data.src) {
                video.setAttribute("src", data.src);
                video.load();
              }
              
              // Update screen material
              screen.setAttribute("material", "src", "#video1");
              
              // Play with error handling
              video.play().catch(err => {
                console.warn("Video playback failed:", err);
                // Try again after user interaction
                setTimeout(() => video.play(), 100);
              });
            } else {
              // Handle image
              screen.setAttribute("material", "src", data.src);
            }
          });
        },
      });
    </script>
  </head>

  <body>
    <a-scene>
      <!-- Camera with cursor and VR controls -->
      <a-entity id="rig" position="0 1.6 3">
        <a-entity camera look-controls wasd-controls>
          <!-- Cursor for non-VR mode -->
          <a-cursor
            color="#FFD700"
            raycaster="objects: .clickable"
            fuse="false"
          ></a-cursor>
          
          <!-- VR Controllers -->
          <a-entity
            laser-controls="hand: right"
            raycaster="objects: .clickable; far: 10"
            line="color: #FFD700; opacity: 0.75"
          ></a-entity>
          
          <a-entity
            laser-controls="hand: left"
            raycaster="objects: .clickable; far: 10"
            line="color: #FFD700; opacity: 0.75"
          ></a-entity>

          <!-- Hand tracking for both hands -->
          <a-entity
            hand-tracking-controls="hand: left"
            raycaster="objects: .clickable; far: 10"
          ></a-entity>
          
          <a-entity
            hand-tracking-controls="hand: right"
            raycaster="objects: .clickable; far: 10"
          ></a-entity>
        </a-entity>
      </a-entity>

      <!-- Enhanced Lighting -->
      <a-light type="ambient" intensity="0.8" color="#FFF"></a-light>
      <a-light type="directional" position="0 5 2" intensity="1.2" color="#FFF"></a-light>
      <a-light type="point" position="0 2 0" intensity="1" color="#FFF"></a-light>

      <!-- Environment -->
      <a-sky color="#1a1a2e"></a-sky>
      <a-plane
        rotation="-90 0 0"
        width="30"
        height="30"
        color="#2a2a3e"
        shadow="receive: true"
      ></a-plane>

      <!-- Title -->
      <a-text
        value="Interactive 3D Media Viewer"
        position="0 4.5 -5"
        align="center"
        width="7"
        color="#FFD700"
        font="roboto"
      ></a-text>

      <!-- Big media screen with frame -->
      <a-entity position="0 3 -5">
        <!-- Screen frame -->
        <a-box
          width="6.3"
          height="3.8"
          depth="0.1"
          color="#1a1a1a"
          position="0 0 -0.05"
        ></a-box>
        
        <!-- Main screen -->
        <a-plane
          id="media-screen"
          width="6"
          height="3.5"
          src="#img1"
          material="shader: flat"
        ></a-plane>
      </a-entity>

      <!-- Media sources -->
      <a-assets>
        <img id="img1" src="https://cdn.aframe.io/a-painter/images/floor.jpg" crossorigin="anonymous" />
        <img id="img2" src="https://cdn.aframe.io/a-painter/images/sky.jpg" crossorigin="anonymous" />
        <img id="img3" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/city.jpg" crossorigin="anonymous" />
        <img id="img4" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/cubes.jpg" crossorigin="anonymous" />
        <video
          id="video1"
          src="https://cdn.aframe.io/videos/atlantis.mp4"
          crossorigin="anonymous"
          loop="true"
          preload="auto"
          playsinline
          webkit-playsinline
        ></video>
      </a-assets>

      <!-- Control Panel Background -->
      <a-plane
        position="0 1.5 -2.8"
        width="7"
        height="1.8"
        color="#0f0f1e"
        opacity="0.8"
        rotation="0 0 0"
      ></a-plane>

      <!-- Buttons row -->
      <a-entity position="0 1.5 -2.5">
        <!-- Button 1 -->
        <a-box
          class="clickable media-btn"
          position="-2.5 0 0"
          width="1.2"
          height="1.2"
          depth="0.15"
          src="#img1"
          material="color: #fff"
          media-button="src: https://cdn.aframe.io/a-painter/images/floor.jpg; mediaType: image"
          shadow="cast: true"
        >
          <a-text
            value="Image 1"
            align="center"
            color="#FFD700"
            width="3"
            position="0 -0.8 0.1"
          ></a-text>
        </a-box>

        <!-- Button 2 -->
        <a-box
          class="clickable media-btn"
          position="-0.8 0 0"
          width="1.2"
          height="1.2"
          depth="0.15"
          src="#img2"
          material="color: #fff"
          media-button="src: https://cdn.aframe.io/a-painter/images/sky.jpg; mediaType: image"
          shadow="cast: true"
        >
          <a-text
            value="Image 2"
            align="center"
            color="#FFD700"
            width="3"
            position="0 -0.8 0.1"
          ></a-text>
        </a-box>

        <!-- Button 3 -->
        <a-box
          class="clickable media-btn"
          position="0.8 0 0"
          width="1.2"
          height="1.2"
          depth="0.15"
          src="#img3"
          material="color: #fff"
          media-button="src: https://cdn.aframe.io/360-image-gallery-boilerplate/img/city.jpg; mediaType: image"
          shadow="cast: true"
        >
          <a-text
            value="Image 3"
            align="center"
            color="#FFD700"
            width="3"
            position="0 -0.8 0.1"
          ></a-text>
        </a-box>

        <!-- Button 4 -->
        <a-box
          class="clickable media-btn"
          position="2.5 0 0"
          width="1.2"
          height="1.2"
          depth="0.15"
          color="#000"
          material="color: #1a1a1a"
          media-button="src: https://cdn.aframe.io/videos/atlantis.mp4; mediaType: video"
          shadow="cast: true"
        >
          <a-text
            value="▶ VIDEO"
            align="center"
            color="#FFD700"
            width="2.5"
            position="0 0 0.08"
          ></a-text>
          <a-text
            value="Play Video"
            align="center"
            color="#FFD700"
            width="3"
            position="0 -0.8 0.1"
          ></a-text>
        </a-box>
      </a-entity>

      <!-- Instructions -->
      <a-text
        value="Point and click on media thumbnails to view"
        position="0 0.3 -2.5"
        align="center"
        width="5"
        color="#999"
      ></a-text>
    </a-scene>
  </body>
</html>