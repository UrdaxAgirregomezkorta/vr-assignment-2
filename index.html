<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive 3D Media Viewer</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script>
      // Component to change the main screen image
      AFRAME.registerComponent("media-button", {
        schema: {
          src: { type: "string" },
        },
        init: function () {
          const el = this.el;
          const data = this.data;

          // visual feedback: hover, click
          el.addEventListener("mouseenter", () => {
            el.setAttribute("scale", "1.2 1.2 1.2");
          });
          el.addEventListener("mouseleave", () => {
            el.setAttribute("scale", "1 1 1");
          });
          el.addEventListener("mousedown", () => {
            el.setAttribute("material", "color", "#FFD700");
          });
          el.addEventListener("mouseup", () => {
            el.setAttribute("material", "color", "#FFFFFF");
          });

          // on click, update the main screen texture
          el.addEventListener("click", () => {
            const screen = document.querySelector("#media-screen");
            if (data.src.endsWith(".mp4")) {
              // if it's a video
              const video = document.querySelector("#video1");
              video.pause();
              video.setAttribute("src", data.src);
              video.play();
              screen.setAttribute("material", "src", "#video1");
            } else {
              // if it's an image
              screen.setAttribute("material", "src", data.src);
            }
          });
        },
      });
    </script>
  </head>

  <body>
    <a-scene>
      <!-- Camera with laser controls (for VR controllers) -->
      <a-entity id="rig" position="0 1.6 3">
        <a-entity camera look-controls wasd-controls>
          <a-entity
            laser-controls="hand: right"
            raycaster="objects: .clickable"
            line="color: #FFD700; opacity: 0.9"
          ></a-entity>
          <a-entity
            hand-tracking-controls="hand: left"
          ></a-entity>
        </a-entity>
      </a-entity>

      <!-- Lighting -->
      <a-light type="ambient" intensity="0.7"></a-light>
      <a-light type="directional" position="2 4 2" intensity="0.8"></a-light>

      <!-- Environment -->
      <a-sky color="#222"></a-sky>
      <a-plane
        rotation="-90 0 0"
        width="20"
        height="20"
        color="#444"
      ></a-plane>

      <!-- Big media screen -->
      <a-plane
        id="media-screen"
        position="0 3 -5"
        width="6"
        height="3.5"
        color="#000"
        material="shader: flat; src: #img1"
      ></a-plane>

      <!-- Media sources -->
      <a-assets>
        <img id="img1" src="https://cdn.aframe.io/a-painter/images/floor.jpg" />
        <img
          id="img2"
          src="https://cdn.aframe.io/a-painter/images/sky.jpg"
        />
        <img
          id="img3"
          src="https://cdn.aframe.io/a-painter/images/floor_normal.jpg"
        />
        <video
          id="video1"
          src="https://cdn.aframe.io/videos/360-video.mp4"
          autoplay="false"
          loop="true"
          crossorigin="anonymous"
        ></video>
      </a-assets>

      <!-- Buttons row -->
      <a-entity position="0 1.5 -3">
        <a-plane
          class="clickable"
          position="-2 0 0"
          width="1"
          height="1"
          src="#img1"
          material="color: #fff"
          media-button="src: https://cdn.aframe.io/a-painter/images/floor.jpg"
        ></a-plane>

        <a-plane
          class="clickable"
          position="0 0 0"
          width="1"
          height="1"
          src="#img2"
          material="color: #fff"
          media-button="src: https://cdn.aframe.io/a-painter/images/sky.jpg"
        ></a-plane>

        <a-plane
          class="clickable"
          position="2 0 0"
          width="1"
          height="1"
          src="#img3"
          material="color: #fff"
          media-button="src: https://cdn.aframe.io/a-painter/images/floor_normal.jpg"
        ></a-plane>

        <a-plane
          class="clickable"
          position="4 0 0"
          width="1"
          height="1"
          color="#fff"
          media-button="src: https://cdn.aframe.io/videos/360-video.mp4"
        >
          <a-text
            value="Video"
            align="center"
            color="#000"
            width="2"
            position="0 0 0.1"
          ></a-text>
        </a-plane>
      </a-entity>

      <!-- Title -->
      <a-text
        value="Interactive 3D Media Viewer"
        position="0 4.8 -5"
        align="center"
        width="8"
        color="#FFD700"
      ></a-text>
    </a-scene>
  </body>
</html>
